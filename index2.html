<html>
<title>Form with W3.CSS Template</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Karma">
<script type="text/javascript" src="lib/jquery-3.3.1.min.js"></script>
    <body>
        </div>
        <form name="f2" method="post" action="donnee.php" class="w3-container">        
            <p>
            <label for='password'>URL:</label>
            <input class="w3-input" type="text" name="url" id='url'/></p>
            <p>ou</p>
            <p>
            <label>Fichier:</label>
            <input class="w3-input" type="file" name="fichier" id='fichier'/></p>
        </form>
		<button id="ajTest">Soumettre</button></p>
		<h1 id="dl"></h1>
		<div id="audio_space"></div>
		
        <script type="text/javascript">
			$(document).ready(function(){
			  $("#ajTest").click(function(){
				var file_data = $('#fichier').prop('files')[0];
			    var form_data = new FormData();    
				form_data.append('file', file_data);
				$.ajax({
					url: 'https://api.havenondemand.com/1/api/async/recognizespeech/v2?apikey=4bf6fe7e-fd9b-47c6-bdc6-38e3b70da60e&language_model=en-gb',
					type: 'POST',
					data: form_data,
					contentType: false,
					processData: false,
					success: function(responseText){
						getJson(responseText);
					}
				});
			  });
			});
			function getJson(job){
				var xhttp = new XMLHttpRequest();
				xhttp.onreadystatechange = function() {
				if (this.readyState == 4 && this.status == 200) {
				  console.log(this.responseText);
				  console.log(this.reponseText);
				}
				};
				var link = "https://api.havenondemand.com/1/job/result/" + job["jobID"] + "?apikey=4bf6fe7e-fd9b-47c6-bdc6-38e3b70da60e";
				xhttp.open("GET", link, true);
				xhttp.send();
			}
        </script>
    </body>
</html>